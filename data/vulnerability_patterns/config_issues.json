[
  {
    "name": "Missing Security Headers",
    "pattern": "helmet|Content-Security-Policy|X-Frame-Options",
    "vulnerability_type": "configuration_issue",
    "severity": "medium",
    "description": "Missing security headers middleware",
    "cwe_id": "CWE-693",
    "owasp_category": "A05:2021 - Security Misconfiguration",
    "fix_suggestion": "Implement helmet middleware for security headers",
    "confidence": 0.6
  },
  {
    "name": "Debug Mode Enabled",
    "pattern": "debug\\s*:\\s*true|DEBUG\\s*=\\s*true",
    "vulnerability_type": "configuration_issue",
    "severity": "medium",
    "description": "Debug mode enabled in production",
    "cwe_id": "CWE-489",
    "owasp_category": "A05:2021 - Security Misconfiguration",
    "fix_suggestion": "Disable debug mode in production",
    "confidence": 0.7
  },
  {
    "name": "Verbose Error Messages",
    "pattern": "error.*stack|error.*message.*req\\.|console\\.error.*req\\.",
    "vulnerability_type": "logging_issue",
    "severity": "low",
    "description": "Verbose error messages may leak sensitive information",
    "cwe_id": "CWE-209",
    "owasp_category": "A09:2021 - Security Logging and Monitoring Failures",
    "fix_suggestion": "Implement proper error handling and logging",
    "confidence": 0.5
  },
  {
    "name": "Missing Input Validation",
    "pattern": "req\\.(body|params|query)\\.\\w+",
    "vulnerability_type": "input_validation",
    "severity": "medium",
    "description": "Direct use of request data without validation",
    "cwe_id": "CWE-20",
    "owasp_category": "A03:2021 - Injection",
    "fix_suggestion": "Implement input validation and sanitization",
    "confidence": 0.4
  },
  {
    "name": "Insecure Random Number Generation",
    "pattern": "Math\\.random|Math\\.floor.*Math\\.random",
    "vulnerability_type": "cryptographic_issue",
    "severity": "medium",
    "description": "Use of Math.random() for security purposes",
    "cwe_id": "CWE-330",
    "owasp_category": "A02:2021 - Cryptographic Failures",
    "fix_suggestion": "Use crypto.getRandomValues() or crypto.randomBytes()",
    "confidence": 0.6
  },
  {
    "name": "Weak Cryptographic Algorithm",
    "pattern": "(MD5|SHA1|DES|RC4)",
    "vulnerability_type": "cryptographic_issue",
    "severity": "medium",
    "description": "Use of weak cryptographic algorithm",
    "cwe_id": "CWE-327",
    "owasp_category": "A02:2021 - Cryptographic Failures",
    "fix_suggestion": "Use stronger algorithms like SHA-256 or AES-256",
    "confidence": 0.8
  },
  {
    "name": "File Upload Without Validation",
    "pattern": "upload.*file|file.*upload|multer",
    "vulnerability_type": "file_upload_vulnerability",
    "severity": "high",
    "description": "File upload without proper validation",
    "cwe_id": "CWE-434",
    "owasp_category": "A01:2021 - Broken Access Control",
    "fix_suggestion": "Implement file type and content validation",
    "confidence": 0.5
  },
  {
    "name": "Missing Rate Limiting",
    "pattern": "rate.*limit|throttle|express-rate-limit",
    "vulnerability_type": "configuration_issue",
    "severity": "medium",
    "description": "No rate limiting implemented",
    "cwe_id": "CWE-770",
    "owasp_category": "A05:2021 - Security Misconfiguration",
    "fix_suggestion": "Implement rate limiting middleware",
    "confidence": 0.3
  }
]
